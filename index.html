<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pixel Snake Survival</title>
  <style>
    body { margin: 0; overflow: hidden; background: #000; }
    canvas { display: block; margin: auto; background: #1a2f1a; }
    #joystick {
      position: absolute;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      height: 120px;
      display: grid;
      grid-template-columns: 40px 40px 40px;
      grid-template-rows: 40px 40px 40px;
      gap: 0;
    }
    .arrow {
      width: 100%;
      height: 100%;
      background: rgba(0,255,0,0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: #0f0;
      user-select: none;
      font-family: monospace;
      border: 1px solid #0f0;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="800" height="600"></canvas>
  <div id="joystick">
    <div></div>
    <div class="arrow" id="up">↑</div>
    <div></div>
    <div class="arrow" id="left">←</div>
    <div></div>
    <div class="arrow" id="right">→</div>
    <div></div>
    <div class="arrow" id="down">↓</div>
    <div></div>
  </div>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");const tileSize = 20;
const mapSize = 2000;
let player = {
  x: 100,
  y: 100,
  dx: 1,
  dy: 0,
  body: [{x: 100, y: 100}]
};
const food = [];
for (let i = 0; i < 50; i++) {
  food.push({
    x: Math.floor(Math.random() * mapSize / tileSize) * tileSize,
    y: Math.floor(Math.random() * mapSize / tileSize) * tileSize
  });
}
const enemies = [];
for (let i = 0; i < 3; i++) {
  enemies.push({
    x: Math.floor(Math.random() * mapSize),
    y: Math.floor(Math.random() * mapSize),
    dx: 1,
    dy: 0,
    body: []
  });
}

let offsetX = 0;
let offsetY = 0;
let growAmount = 0;

function drawGrid() {
  ctx.strokeStyle = "#264d26";
  ctx.lineWidth = 0.5;
  for (let x = -offsetX % tileSize; x < canvas.width; x += tileSize) {
    ctx.beginPath();
    ctx.moveTo(x, 0);
    ctx.lineTo(x, canvas.height);
    ctx.stroke();
  }
  for (let y = -offsetY % tileSize; y < canvas.height; y += tileSize) {
    ctx.beginPath();
    ctx.moveTo(0, y);
    ctx.lineTo(canvas.width, y);
    ctx.stroke();
  }
}

function draw() {
  ctx.fillStyle = "#1a2f1a";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  offsetX = player.x - canvas.width / 2;
  offsetY = player.y - canvas.height / 2;

  drawGrid();

  ctx.fillStyle = "red";
  food.forEach(f => {
    ctx.fillRect(f.x - offsetX, f.y - offsetY, tileSize, tileSize);
  });

  ctx.fillStyle = "#0f0";
  player.body.forEach(segment => {
    ctx.fillRect(segment.x - offsetX, segment.y - offsetY, tileSize, tileSize);
  });

  ctx.fillStyle = "orange";
  enemies.forEach(e => {
    e.body.forEach(segment => {
      ctx.fillRect(segment.x - offsetX, segment.y - offsetY, tileSize, tileSize);
    });
  });
}

function update() {
  const head = { x: player.body[0].x + player.dx * tileSize, y: player.body[0].y + player.dy * tileSize };
  player.body.unshift(head);

  const index = food.findIndex(f => f.x === head.x && f.y === head.y);
  if (index > -1) {
    food.splice(index, 1);
    growAmount += 3; // panjangkan saat makan
  }

  if (growAmount > 0) {
    growAmount--;
  } else {
    player.body.pop();
  }

  player.x = head.x;
  player.y = head.y;

  enemies.forEach(e => {
    if (!e.body.length) {
      e.body.push({ x: e.x, y: e.y });
    }
    const dir = Math.random() < 0.5 ? [1, 0] : [0, 1];
    if (Math.random() < 0.5) dir[0] *= -1; else dir[1] *= -1;
    const newHead = {
      x: e.body[0].x + dir[0] * tileSize,
      y: e.body[0].y + dir[1] * tileSize
    };
    e.body.unshift(newHead);
    e.body.pop();
    e.x = newHead.x;
    e.y = newHead.y;
  });
}

document.addEventListener("keydown", (e) => {
  if (e.key === "ArrowUp") { player.dx = 0; player.dy = -1; }
  if (e.key === "ArrowDown") { player.dx = 0; player.dy = 1; }
  if (e.key === "ArrowLeft") { player.dx = -1; player.dy = 0; }
  if (e.key === "ArrowRight") { player.dx = 1; player.dy = 0; }
});

document.getElementById("up").addEventListener("click", () => { player.dx = 0; player.dy = -1; });
document.getElementById("down").addEventListener("click", () => { player.dx = 0; player.dy = 1; });
document.getElementById("left").addEventListener("click", () => { player.dx = -1; player.dy = 0; });
document.getElementById("right").addEventListener("click", () => { player.dx = 1; player.dy = 0; });

setInterval(() => {
  update();
  draw();
}, 150);

  </script>
</body>
</html>
