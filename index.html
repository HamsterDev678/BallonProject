<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pixel Snake Survival</title>
  <style>
    body { margin: 0; overflow: hidden; background: #000; }
    canvas { display: block; margin: auto; background: #111; }
    #joystick {
      position: absolute;
      bottom: 30px;
      left: 30px;
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background: rgba(255,255,255,0.1);
      touch-action: none;
    }
    #stick {
      position: absolute;
      width: 40px;
      height: 40px;
      background: #0f0;
      border-radius: 50%;
      top: 30px;
      left: 30px;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="800" height="600"></canvas>
  <div id="joystick">
    <div id="stick"></div>
  </div>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");const tileSize = 20;
const mapSize = 2000; // huge map
let player = {
  x: 100,
  y: 100,
  dx: 1,
  dy: 0,
  body: [{x: 100, y: 100}]
};
const food = [];
for (let i = 0; i < 50; i++) {
  food.push({
    x: Math.floor(Math.random() * mapSize / tileSize) * tileSize,
    y: Math.floor(Math.random() * mapSize / tileSize) * tileSize
  });
}

// Enemy snakes
const enemies = [];
for (let i = 0; i < 3; i++) {
  enemies.push({
    x: Math.floor(Math.random() * mapSize),
    y: Math.floor(Math.random() * mapSize),
    dx: 1,
    dy: 0,
    body: []
  });
}

let offsetX = 0;
let offsetY = 0;

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  offsetX = player.x - canvas.width / 2;
  offsetY = player.y - canvas.height / 2;

  // Draw food
  ctx.fillStyle = "red";
  food.forEach(f => {
    ctx.fillRect(f.x - offsetX, f.y - offsetY, tileSize, tileSize);
  });

  // Draw player snake
  ctx.fillStyle = "lime";
  player.body.forEach(segment => {
    ctx.fillRect(segment.x - offsetX, segment.y - offsetY, tileSize, tileSize);
  });

  // Draw enemy snakes
  ctx.fillStyle = "orange";
  enemies.forEach(e => {
    e.body.forEach(segment => {
      ctx.fillRect(segment.x - offsetX, segment.y - offsetY, tileSize, tileSize);
    });
  });
}

function update() {
  const head = { x: player.body[0].x + player.dx * tileSize, y: player.body[0].y + player.dy * tileSize };
  player.body.unshift(head);

  // Makan?
  const index = food.findIndex(f => f.x === head.x && f.y === head.y);
  if (index > -1) {
    food.splice(index, 1);
  } else {
    player.body.pop();
  }
  player.x = head.x;
  player.y = head.y;

  // Update enemies
  enemies.forEach(e => {
    if (!e.body.length) {
      e.body.push({ x: e.x, y: e.y });
    }
    const dir = Math.random() < 0.5 ? [1, 0] : [0, 1];
    if (Math.random() < 0.5) dir[0] *= -1; else dir[1] *= -1;
    const newHead = {
      x: e.body[0].x + dir[0] * tileSize,
      y: e.body[0].y + dir[1] * tileSize
    };
    e.body.unshift(newHead);
    e.body.pop();
    e.x = newHead.x;
    e.y = newHead.y;
  });
}

// Keyboard Control
document.addEventListener("keydown", (e) => {
  if (e.key === "ArrowUp") { player.dx = 0; player.dy = -1; }
  if (e.key === "ArrowDown") { player.dx = 0; player.dy = 1; }
  if (e.key === "ArrowLeft") { player.dx = -1; player.dy = 0; }
  if (e.key === "ArrowRight") { player.dx = 1; player.dy = 0; }
});

// Joystick Control
const joystick = document.getElementById("joystick");
const stick = document.getElementById("stick");
let dragging = false;
let startX, startY;

stick.addEventListener("touchstart", (e) => {
  dragging = true;
  const touch = e.touches[0];
  startX = touch.clientX;
  startY = touch.clientY;
});

stick.addEventListener("touchmove", (e) => {
  if (!dragging) return;
  const touch = e.touches[0];
  const dx = touch.clientX - startX;
  const dy = touch.clientY - startY;

  if (Math.abs(dx) > Math.abs(dy)) {
    player.dx = dx > 0 ? 1 : -1;
    player.dy = 0;
  } else {
    player.dy = dy > 0 ? 1 : -1;
    player.dx = 0;
  }
});

stick.addEventListener("touchend", () => {
  dragging = false;
});

// Game loop
setInterval(() => {
  update();
  draw();
}, 150);

  </script>
</body>
</html>
